# Вероятностные структуры данных

## Фильтр Блума

Фильтр Блума (англ. Bloom filter) — это вероятностная структура данных, придуманная Бёртоном Блумом в 1970 году, позволяющая проверять принадлежность элемента к множеству. При этом существует возможность получить ложноположительное срабатывание (элемента в множестве нет, но структура данных сообщает, что он есть), но не ложноотрицательное.

Фильтр Блума может использовать любой объём памяти, заранее заданный пользователем, причём чем он больше, тем меньше вероятность ложного срабатывания. Поддерживается операция добавления новых элементов в множество, но не удаления существующих (если только не используется модификация со счётчиками).

По сравнению с [хеш-таблицами](https://ru.wikipedia.org/wiki/Хеш-таблица) фильтр Блума может обходиться на несколько порядков меньшими объёмами памяти, жертвуя детерминизмом. Обычно он используется для уменьшения числа запросов к несуществующим данным в структуре данных с более дорогостоящим доступом (например, расположенной на жестком диске или в сетевой базе данных), то есть для «фильтрации» запросов к ней.


Как фильтр это делает? Как я уже говорил, идея до гениальности проста. Заводится массив битов фиксированного размера `m` и набор из `k` различных хеш-функций, выдающих значения от `0` до `m - 1`. При необходимости добавить элемент к множеству, для элемента считается значение каждой хеш-функции и в массиве устанавливаются биты с соответствующими индексами.

Для проверки принадлежности, как вы уже догадались, достаточно посчитать значения хеш-функций для потенциального члена и убедиться, что все соответствующие биты установлены в единицу — это и будет ответом «возможно». Если же хотя бы один бит не равен единице, значит множество этого элемента не содержит — ответ «нет», элемент отфильтрован.



Примеры практических применений:

- Прокси-сервер [Squid](https://ru.wikipedia.org/wiki/Squid) использует фильтры Блума для опции [cache digests](http://wiki.squid-cache.org/SquidFaq/CacheDigests).
- [Google](https://ru.wikipedia.org/wiki/Google_(компания)) [BigTable](https://ru.wikipedia.org/wiki/BigTable) использует фильтры Блума для уменьшения числа обращений к жесткому диску при проверке на существование заданной строки или столбца в таблице базы данных.
- Компьютерные программы для проверки орфографии.



- MinHash
- LogLog